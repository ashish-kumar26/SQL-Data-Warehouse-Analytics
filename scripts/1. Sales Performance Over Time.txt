/*
1. Sales Performance Over Time
Purpose:
  Analyze how sales performance evolves over time.

Key Features:
  ● Monthly total sales
  ● Unique customers per month
  ● Total quantity sold
  ● Identifies seasonality and growth trends
*/

SELECT 
    TO_CHAR(order_date, 'YYYY-Mon') AS order_date,
    SUM(sales_amount) AS total_sales,
	COUNT(DISTINCT customer_key) AS total_customers,
	SUM(quantity) AS total_quantity
FROM gold.fact_sales
WHERE order_date IS NOT NULL
GROUP BY TO_CHAR(order_date, 'YYYY-Mon')
ORDER BY TO_CHAR(order_date, 'YYYY-Mon');